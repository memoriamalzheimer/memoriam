<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="/assets/favicon/cerebro.png">
    <link rel="stylesheet" href="../css/faq.css">
    <link rel="stylesheet" href="../css/configgerais.css">
    <title>Memoriam: FAQ</title>
</head>

<body>
    <header>
        <nav class="itens">
            <ul>
                <li class="logo">
                    <img src="../../assets/logo.png" alt="logo" draggable="false">
                    <h2>Memoriam</h2>
                    <span class="social">
                        <img src="../../assets/instagram.svg" draggable="false" alt="Instagram">
                        <img src="../../assets/facebook.svg" draggable="false" alt="Facebook">
                        <img src="../../assets/twitter.svg" draggable="false" alt="Twitter">
                    </span>
                </li>
                <li><a href="<%= usuario ? '/inicio' : '/' %>">Início</a></li>
                <li><a href="/sobre">Sobre</a></li>
                <li><a href="/jogos">Jogos</a></li>
                <li><a href="#" class="ativo">Perguntas Frequentes</a></li>
                <li>
                    <a href="/convite" id="linkConvite">
                        Convites
                        <span id="contadorConvite">0</span>
                    </a>
                </li>

                <li class="dropdown-login">
                    <% if (usuario) { %>
                        <a href="/logout">Sair</a>
                        <% } else { %>
                            <span class="dropdown-toggle">Login ▼</span>
                            <div class="dropdown-content-login">
                                <a href="/login">Entrar</a>
                                <a href="/registro">Registrar</a>
                            </div>
                            <% } %>
                </li>
            </ul>
        </nav>
    </header>

    <main class="faq-container">
        <h1>Perguntas Frequentes</h1>

        <div class="faq-item">
            <h2 onclick="toggleAnswer(this)">Como funciona a plataforma?</h2>
            <p class="answer">A plataforma Memoriam oferece atividades e jogos para estimular funções cognitivas de
                idosos, especialmente no contexto do Alzheimer.</p>
        </div>

        <div class="faq-item">
            <h2 onclick="toggleAnswer(this)">Meus dados são armazenados online?</h2>
            <p class="answer">Não. Os dados ficam armazenados localmente no navegador do usuário, garantindo
                privacidade.</p>
        </div>

        <div class="faq-item">
            <h2 onclick="toggleAnswer(this)">É necessário criar uma conta?</h2>
            <p class="answer">Não é necessário. Você pode usar a plataforma livremente sem criar uma conta.</p>
        </div>

        <div class="faq-item">
            <h2 onclick="toggleAnswer(this)">Como posso resetar os dados?</h2>
            <p class="answer">Na página de acompanhamento, há um botão "Resetar" que apaga todos os dados salvos
                localmente.</p>
        </div>

        <section class="faq-form">
            <h2>Não encontrou sua dúvida?</h2>
            <form id="faq-form">
                <% if (usuario) { %>
                    <input type="hidden" name="email" value="<%= usuario.email %>">
                    <% } %>

                        <label for="pergunta">Envie sua pergunta:</label>
                        <textarea name="pergunta" id="pergunta" rows="4" required></textarea>
                        <button type="submit" id="submit">Enviar</button>
            </form>
        </section>
    </main>
    <script src="https://cdn.emailjs.com/dist/email.min.js"></script>
    <script>
        emailjs.init("e0yS1nwLBaxrzQdjq");

        document.getElementById('faq-form').addEventListener('submit', function (e) {
            e.preventDefault();

            emailjs.sendForm('service_memoriam', 'template_5hn6gdh', this)
                .then(() => {
                    alert('Pergunta enviada com sucesso!');
                })
                .catch(err => {
                    alert('Erro ao enviar: ' + JSON.stringify(err));
                });
        });

        function toggleAnswer(el) {
            const answer = el.nextElementSibling;
            if (answer.classList.contains("open")) {
                answer.classList.remove("open");
                answer.classList.add("closing");
                setTimeout(() => { answer.classList.remove("closing"); }, 280);
            } else {
                answer.classList.add("open");
            }
        }

        window.onload = function () {
            document.querySelectorAll('.answer').forEach(p => p.classList.remove('open'));
        };

        document.addEventListener("keypress", function (e) {
            if (e.key === 'Enter') {
                var btn = document.querySelector("#submit");
                btn.click();
            }
        });
    </script>

    <script src="/socket.io/socket.io.js"></script>
    <script>
    (function () {
    const socket = io();
    const meuId = "<%= usuario ? usuario.id : '' %>";
    socket.emit('registrarId', meuId);

    const contador = document.getElementById('contadorConvite');
    let convites = JSON.parse(localStorage.getItem('convitesPendentes') || '[]');
    let notificacoes = convites.length;

    function atualizarContador() {
        if (notificacoes > 0) {
            contador.style.display = 'inline-block';
            contador.textContent = notificacoes;
        } else {
            contador.style.display = 'none';
        }
    }

    function salvarConvites() {
        localStorage.setItem('convitesPendentes', JSON.stringify(convites));
    }

    document.getElementById('linkConvite').addEventListener('click', () => {
         notificacoes = 0;
        atualizarContador();
    });

     socket.on('conviteRecebido', ({ de, conviteId }) => {
        const id = conviteId || 'local-' + Date.now() + '-' + Math.floor(Math.random() * 1000);
        convites.push({ id, tipo: 'jogo', de, timestamp: Date.now() });
        notificacoes++;
        salvarConvites();
        atualizarContador();
    });

    socket.on('conviteVideoRecebido', ({ de, conviteId }) => {
        const id = conviteId || 'local-' + Date.now() + '-' + Math.floor(Math.random() * 1000);
        convites.push({ id, tipo: 'video', de, timestamp: Date.now() });
        notificacoes++;
        salvarConvites();
        atualizarContador();
    });

    atualizarContador();
})();
    </script>

    <footer>
        <div class="footer-top">
            <ul>
                <li>Início</li>
                <li>Sobre</li>
                <li>Jogos</li>
            </ul>
            <ul>
                <li>FAQ</li>
                <li>Convites</li>
                <li>Doação</li>
            </ul>
            <ul>
                <li>Twitter</li>
                <li>Instagram</li>
                <li>Facebook</li>
            </ul>
        </div>
        <div class="footer-bottom">
            © 2025 Todos os direitos reservados.
        </div>
    </footer>
    <script src="../../js/atraso.js"></script>
</body>

</html>